@page "{id:int}"
@model OnlineLearningPlatform.RazorPages.Pages.Quiz.ManageQuestionsModel
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
<div class="container mt-4">
    <div class="d-flex justify-content-between mb-4 align-items-center">
        <h4>Quản lý Quiz: <span class="text-primary">@Model.Quiz?.Title</span></h4>
        <a asp-area="Teacher" asp-page="/Dashboard" class="btn btn-secondary shadow-sm">Xong & Quay lại</a>
    </div>
    <div class="row">
        <div class="col-md-4">
            <div class="card shadow-sm mb-4 border-warning">
                <div class="card-header bg-warning fw-bold">Thông tin Quiz</div>
                <div class="card-body">
                    <form method="post" asp-page-handler="UpdateQuiz">
                        <input type="hidden" asp-for="Quiz.QuizId" /><input type="hidden" asp-for="Quiz.LessonId" />
                        <div class="mb-2"><label class="small fw-bold">Tiêu đề</label><input asp-for="Quiz.Title" class="form-control" /></div>
                        <div class="mb-2"><label class="small fw-bold">Điểm đạt (%)</label><input asp-for="Quiz.PassingScore" class="form-control" type="number" /></div>
                        <div class="mb-3"><label class="small fw-bold">Thời gian (p)</label><input asp-for="Quiz.TimeLimitMinutes" class="form-control" type="number" /></div>
                        <button type="submit" class="btn btn-warning w-100 mb-2 fw-bold">Lưu thay đổi</button>
                    </form>
                    <form method="post" asp-page-handler="DeleteQuiz" onsubmit="return confirm('Xóa sạch bài này?')">
                        <input type="hidden" name="quizId" value="@Model.Quiz.QuizId" />
                        <button type="submit" class="btn btn-outline-danger btn-sm w-100">Xóa bài Quiz</button>
                    </form>
                </div>
            </div>
        </div>
        <div class="col-md-8">
            <div class="card shadow-sm border-primary mb-4">
                <div class="card-header bg-primary text-white fw-bold">Thêm câu hỏi mới</div>
                <div class="card-body">
                    <form method="post" asp-page-handler="AddQuestion">
                        <textarea asp-for="MainContent" class="form-control mb-3" placeholder="Nội dung câu hỏi..." required></textarea>
                        <div class="row mb-3">
                            <div class="col-6 mb-2">A: <input asp-for="OptA" class="form-control form-control-sm" required /></div>
                            <div class="col-6 mb-2">B: <input asp-for="OptB" class="form-control form-control-sm" required /></div>
                            <div class="col-6">C: <input asp-for="OptC" class="form-control form-control-sm" required /></div>
                            <div class="col-6">D: <input asp-for="OptD" class="form-control form-control-sm" required /></div>
                        </div>
                        <div class="d-flex align-items-center">
                            <select asp-for="NewQuestion.CorrectAnswer" class="form-select form-select-sm w-25 me-3">
                                <option value="A">Đáp án A</option>
                                <option value="B">Đáp án B</option>
                                <option value="C">Đáp án C</option>
                                <option value="D">Đáp án D</option>
                            </select>
                            <button type="submit" class="btn btn-success">+ Lưu câu hỏi</button>
                        </div>
                    </form>
                </div>
            </div>
            <h5 class="mb-3">Danh sách câu hỏi hiện có</h5>
            @foreach (var q in Model.Quiz.Questions)
            {
                var p = q.Content.Split('|');
                <div class="alert alert-light border shadow-sm d-flex justify-content-between py-2 align-items-center">
                    <span><strong>@p[0]</strong> <small class="text-success ms-3 fw-bold">Đáp án: @q.CorrectAnswer</small></span>
                    <form method="post" asp-page-handler="DeleteQuestion" asp-route-questionId="@q.QuestionId" asp-route-quizId="@Model.Quiz.QuizId">
                        <button class="btn btn-link text-danger p-0"><i class="bi bi-trash-fill"></i></button>
                    </form>
                </div>
            }
        </div>
    </div>
</div>