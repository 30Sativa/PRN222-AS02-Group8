@page "{id}"
@model OnlineLearningPlatform.RazorPages.Areas.Admin.Pages.Users.EditModel
@{
    ViewData["Title"] = "Chá»‰nh sá»­a User";
}

<div class="page-header fade-in">
    <h1>âœï¸ Chá»‰nh sá»­a NgÆ°á»i dÃ¹ng</h1>
    <span class="breadcrumb-text">
        <a asp-area="Admin" asp-page="/Dashboard" style="color:var(--primary);">Dashboard</a> â†’
        <a asp-area="Admin" asp-page="/Users/Index" style="color:var(--primary);">Users</a> â†’
        Chá»‰nh sá»­a
    </span>
</div>

@if (Model.UserInfo == null)
{
    <div class="olp-alert olp-alert-danger">âš ï¸ KhÃ´ng tÃ¬m tháº¥y ngÆ°á»i dÃ¹ng nÃ y.</div>
    <a asp-page="/Users/Index" class="btn-secondary-olp">â† Quay láº¡i</a>
}
else
{
    <!-- ThÃ´ng bÃ¡o -->
    @if (Model.SuccessMessage != null)
    {
        <div class="olp-alert olp-alert-success fade-in">âœ… @Model.SuccessMessage</div>
    }
    @if (Model.ErrorMessage != null)
    {
        <div class="olp-alert olp-alert-danger fade-in">âŒ @Model.ErrorMessage</div>
    }

    <!-- FORM 1: Chá»‰nh sá»­a thÃ´ng tin -->
    <div class="olp-card fade-in mb-2">
        <div class="olp-card-header">
            <h2>ğŸ“ ThÃ´ng tin ngÆ°á»i dÃ¹ng</h2>
            <span class="badge @(Model.UserInfo.Role == "Admin" ? "badge-admin" : Model.UserInfo.Role == "Teacher" ? "badge-teacher" : "badge-student")">
                @Model.UserInfo.Role
            </span>
        </div>
        <div class="olp-card-body">
            <form method="post" asp-page-handler="UpdateInfo" asp-route-id="@Model.UserInfo.Id">
                <!-- Email (chá»‰ Ä‘á»c) -->
                <div class="olp-form-group">
                    <label>ğŸ“§ Email</label>
                    <input type="text" class="olp-form-control" value="@Model.UserInfo.Email" disabled />
                    <span class="olp-form-hint">Email khÃ´ng Ä‘Æ°á»£c phÃ©p thay Ä‘á»•i.</span>
                </div>

                <!-- Há» tÃªn -->
                <div class="olp-form-group">
                    <label asp-for="Input.FullName">ğŸ‘¤ Há» vÃ  tÃªn</label>
                    <input asp-for="Input.FullName" class="olp-form-control" placeholder="Nháº­p há» tÃªn" />
                    <span asp-validation-for="Input.FullName" class="text-danger" style="font-size:.8rem;"></span>
                </div>

                <!-- Bio -->
                <div class="olp-form-group">
                    <label asp-for="Input.Bio">ğŸ“ Giá»›i thiá»‡u</label>
                    <textarea asp-for="Input.Bio" class="olp-form-control" placeholder="Giá»›i thiá»‡u ngáº¯n..."></textarea>
                </div>

                <!-- SÄT -->
                <div class="olp-form-group">
                    <label asp-for="Input.PhoneNumber">ğŸ“± Sá»‘ Ä‘iá»‡n thoáº¡i</label>
                    <input asp-for="Input.PhoneNumber" class="olp-form-control" placeholder="Nháº­p SÄT" />
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn-success-olp">ğŸ’¾ LÆ°u thÃ´ng tin</button>
                    <a asp-page="/Users/Detail" asp-route-id="@Model.UserInfo.Id" class="btn-secondary-olp">â† Há»§y</a>
                </div>
            </form>
        </div>
    </div>

    <!-- FORM 2: Äá»•i Role -->
    <div class="olp-card fade-in">
        <div class="olp-card-header">
            <h2>ğŸ”‘ Thay Ä‘á»•i Role</h2>
        </div>
        <div class="olp-card-body">
            <form method="post" asp-page-handler="ChangeRole" asp-route-id="@Model.UserInfo.Id"
                  onsubmit="return confirm('Báº¡n cháº¯c cháº¯n muá»‘n Ä‘á»•i role cá»§a ngÆ°á»i dÃ¹ng nÃ y?');">
                <div class="olp-form-group">
                    <label>Role hiá»‡n táº¡i: <strong>@Model.UserInfo.Role</strong></label>
                    <select asp-for="NewRole" class="olp-form-control" style="max-width:300px;">
                        <option value="Admin" selected="@(Model.UserInfo.Role == "Admin")">Admin</option>
                        <option value="Teacher" selected="@(Model.UserInfo.Role == "Teacher")">Teacher</option>
                        <option value="Student" selected="@(Model.UserInfo.Role == "Student")">Student</option>
                    </select>
                    <span class="olp-form-hint">âš ï¸ Äá»•i role sáº½ thay Ä‘á»•i quyá»n truy cáº­p cá»§a ngÆ°á»i dÃ¹ng ngay láº­p tá»©c.</span>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn-primary-olp">ğŸ”„ Äá»•i Role</button>
                </div>
            </form>
        </div>
    </div>
}

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
