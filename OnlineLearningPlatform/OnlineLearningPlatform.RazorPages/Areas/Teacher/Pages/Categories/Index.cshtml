@page
@model OnlineLearningPlatform.RazorPages.Areas.Teacher.Pages.Categories.IndexModel
@{
    ViewData["Title"] = "Quản lý danh mục";
}

<style>
    .cat-page { animation: fadeUp .35s ease forwards; }

    .cat-header {
        display: flex; align-items: flex-start; justify-content: space-between;
        margin-bottom: var(--space-6); gap: var(--space-4); flex-wrap: wrap;
    }
    .cat-header-text h1 { font-size: var(--text-xl); font-weight: 700; letter-spacing: -.03em; color: var(--color-label-1); margin-bottom: var(--space-1); }
    .cat-header-text p  { font-size: var(--text-sm); color: var(--color-label-2); }

    .cat-badge {
        display: inline-flex; align-items: center; gap: 6px;
        padding: 4px 12px; border-radius: var(--radius-full);
        background: var(--color-blue-tint); color: var(--color-blue);
        font-size: var(--text-xs); font-weight: 600; margin-bottom: var(--space-2);
    }

    .tag-grid {
        display: flex; flex-wrap: wrap; gap: var(--space-3);
        padding: var(--space-8);
    }

    .tag-item {
        display: inline-flex; align-items: center; gap: var(--space-2);
        background: var(--color-surface-2);
        border: 1px solid var(--color-border-light);
        border-radius: var(--radius-full);
        padding: 8px 16px;
        font-size: var(--text-sm); color: var(--color-label-1); font-weight: 500;
        transition: background var(--transition), box-shadow var(--transition);
    }
    .tag-item:hover { background: var(--color-surface); box-shadow: var(--shadow-sm); }

    .tag-actions { display: flex; align-items: center; gap: var(--space-1); margin-left: var(--space-1); }
    .tag-btn {
        display: inline-flex; align-items: center; justify-content: center;
        width: 22px; height: 22px; border-radius: 50%;
        border: none; background: transparent; cursor: pointer;
        color: var(--color-label-3); font-size: 12px;
        transition: background var(--transition), color var(--transition);
        text-decoration: none; line-height: 1;
    }
    .tag-btn:hover { background: var(--color-border-light); opacity: 1; }
    .tag-btn-delete:hover { background: var(--color-red-tint); color: var(--color-red); }

    .empty-cats {
        padding: var(--space-16) var(--space-8); text-align: center;
        color: var(--color-label-2);
    }
    .empty-cats svg { margin: 0 auto var(--space-4); display: block; color: var(--color-label-3); }
    .empty-cats p { font-size: var(--text-sm); margin-bottom: var(--space-5); }
</style>

<div class="cat-page">
    <div class="page-head">
        <h1>Danh mục khóa học</h1>
        <div class="breadcrumb">
            <a asp-area="Teacher" asp-page="/Dashboard">Dashboard</a>
            <span class="breadcrumb-sep">›</span>
            <span>Danh mục</span>
        </div>
    </div>

    @if (TempData["SuccessMessage"] is string successMsg)
    {
        <div class="alert alert-success">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
            @successMsg
        </div>
    }
    @if (TempData["ErrorMessage"] is string errMsg)
    {
        <div class="alert alert-danger">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
            @errMsg
        </div>
    }

    <div class="card">
        <div class="card-header">
            <div>
                <span class="cat-badge">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
                    @Model.Categories.Count danh mục
                </span>
                <h2>Tất cả danh mục</h2>
            </div>
            <a asp-area="Teacher" asp-page="/Categories/Create" class="btn btn-primary">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                Tạo danh mục
            </a>
        </div>

        @if (!Model.Categories.Any())
        {
            <div class="empty-cats">
                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 7V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2"/>
                </svg>
                <p>Chưa có danh mục nào.<br/>Hãy tạo danh mục đầu tiên để phân loại khóa học của bạn.</p>
                <a asp-area="Teacher" asp-page="/Categories/Create" class="btn btn-primary">Tạo danh mục đầu tiên</a>
            </div>
        }
        else
        {
            <div class="tag-grid">
                @foreach (var cat in Model.Categories)
                {
                    <div class="tag-item">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color:var(--color-blue);flex-shrink:0"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
                        @cat.CategoryName
                        <div class="tag-actions">
                            <a asp-area="Teacher" asp-page="/Categories/Edit" asp-route-id="@cat.CategoryId"
                               class="tag-btn" title="Chỉnh sửa">
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                            </a>
                            <a asp-area="Teacher" asp-page="/Categories/Delete" asp-route-id="@cat.CategoryId"
                               class="tag-btn tag-btn-delete" title="Xóa">
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14H6L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/><path d="M9 6V4h6v2"/></svg>
                            </a>
                        </div>
                    </div>
                }
            </div>
        }
    </div>
</div>
